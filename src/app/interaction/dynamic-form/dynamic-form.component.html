
<ng-template #recursiveBlock let-blocks let-group="formGroup">
    <ng-container *ngFor="let block of blocks">
        <mat-card class="mat-elevation-z4" [ngStyle]="block.style">
            <mat-card-title>
                <div>
                    <span>{{block.block_title}}</span>
                </div>
                <div *ngIf="block.description && block.description.length">
                    <span>{{block.description}}</span>
                </div>
            </mat-card-title>
            <mat-divider></mat-divider>
            <mat-card-content>
                <form [formGroup]="group.get(block.key)" (ngSubmit)="onSubmit()">
                    <div *ngIf="block && block.fields.length" fxLayout="column">
                        <ng-container *ngFor="let field of block.fields">
                            <mat-form-field *ngIf="field.fieldType === 'input'">
                                <mat-label>{{field.label}}</mat-label>
                                <input 
                            
                                [autocomplete]="field.autocomplete"
								[type]="field.InputType"
								[required]="field.required"
								[placeholder]="field.placeholder"
                                [formControlName]="field.key" 
                                matInput>
                            </mat-form-field>
                        </ng-container>
                    </div>
                    <div *ngIf="block && block.children.length">
                        <ng-container
                            *ngTemplateOutlet="recursiveBlock; context:{ $implicit: block.children, formGroup : group.get(block.key) }">

                        </ng-container>
                    </div>
                </form>
            </mat-card-content>
            <mat-divider></mat-divider>
            <mat-card-actions>
            </mat-card-actions>
        </mat-card>
    </ng-container>
</ng-template>
<ng-container
    *ngTemplateOutlet="recursiveBlock; context:{ $implicit: (dynamicForm$ | async)?.model,  formGroup : dynamicForm }">
</ng-container>